\subsection{Attacks on Variants of \LWE} \label{sec:AttacksOnVariants}

In \cite{STOC:BLPRS13}, the classical hardness of \LWE is proved via a reduction to the so-called binary-\LWE, where the secret vector $\svec$ is chosen from $\{ 0,1\}^n$. While this version of \LWE is shown to be at least as hard as standard \LWE in \cite{STOC:BLPRS13}, the reduction loses a factor of $\log q$ in the dimension. Further, Kirchner and Fouque show in \cite{C:KirFou15} that for binary \LWE, a version of the \BKW algorithm achieves slightly sub-exponential running time of order $\smash[t]{2^{\bigO( \frac{n}{\log \log n} )}}$. The \BDD attack can also profit from the fact that the secret is smaller than the error: Bai and Galbraith describe in \cite{ACISP:BaiGal14} how to tweak a \BDD instance for a faster attack. Our experiments confirm (see Table~\ref{table:RunTimesBinSecret}) that indeed for binary-\LWE we can tackle considerably higher dimensions than for standard \LWE. Further, the dimensions we attack are larger than those solved in \cite{C:KirFou15} yet using much lower sample-complexity.

While binary-\LWE remains to be hard and only requires to slightly increase the lattice-dimension in order to achieve the same security-level as standard \LWE, other modifications to \LWE might be fatal for cryptographic applications. For instance, we show that the cryptosystem based on the hardness of `binary' matrix \LWE proposed in \cite{Galb}, can be broken in several hours for relatively large dimensions using the \BDD attack. We note that we attack Regev's \emph{cryptosystem} (\cite{STOC:Regev05}) instantiated with a binary matrix. The binary matrix \LWE problem itself remains an interesting cryptanalytic target.

\paragraph{Binary secret \LWE.} To speed-up the binary-secret \LWE attack, Bai and Galbraith transform a \BDD instance $(\qLat(\AMat\transpose), \bvec)$ with error $\evec$ into a \BDD instance
\begin{equation} \label{eq:binLWEBDDInstance}
 \left( \qLATTp( \Id_m \, | \, \AMat\transpose), (\bvec, \zerovec) \right)
\end{equation}
with the unbalanced error $(\evec, \svec)$. The instance is correctly defined since
\[
	\footnotesize\arraycolsep=0.8\arraycolsep
	( \Id_m \, | \, \AMat\transpose) \Bigg[ \begin{pmatrix}  \evec \\ \svec \end{pmatrix} - \begin{pmatrix}  \tvec \\ \zerovec \end{pmatrix} \Bigg] = 0 \bmod q.
\]
The lattice $\qLATTp( \Id_m \, | \, \AMat\transpose) \in \Z^{m+n}$ is generated by the columns of $\AMat^{\perp}$ given by
\[
	\AMat^{\perp} = \left(
	\begin{matrix}
	-\AMat\transpose \\
	\const \Id_n \\
	\end{matrix}
	\, \middle\vert \,
	q\Id_{n+m}
	\right),	
\]
where $\const$ is some input parameter that re-balances the error by increasing the determinant of the lattice. Larger determinant and hence, larger $\lambda_1(\AMat^{\perp})$, will speed-up the \BDD attack.

We run the \BDD enumeration algorithm described in Alg.~\ref{alg:GenPrunDepth} in both single- and multi-threaded variants. The results are presented in the table below. Notice that in contrast to the \BKW attack of Kirchner and Fouque \cite{C:KirFou15}, we choose as few samples as possible (while keeping a unique solution) to aid the reduction step. Concretely, we used only $m=150$ \LWE samples as opposed to $2^{28}$ samples required in the \BKW attack. We also observe an almost perfect speed-up during a 10-threaded run on an instance of dimension $140$.  
\vspace{20pt}
\begin{table}[h]
	\centering
	\begin{tabular}{cccc|cc|cc}
		\toprule
		\multicolumn{4}{c|}{\LWE-parameters}               & \multicolumn{2}{c|}{\BKZ-reduction}  & \multicolumn{2}{c}{Length Pruning} \\
		$n$   & $q$      & $\alpha$                     & $m$   & $\beta$ & $T$         & $\nT$ &  $T$      \\\midrule
		$120$ & $16411$  & $0.001$                     & $150$ & $10$    & $2.3$h      &  $1$  & $2$h     \\
		$130$ & $16411$  & $0.001$                     & $150$ & $15$    & $6.6$h      &  $1$  & $1$h     \\ \midrule
		$140$ & $16411$  & $0.001$                     & $170$ & $15$    & $12$h       &  $1$  & $16.3$h  \\
		$140$ & $16411$  & $0.001$                     & $170$ & $15$    & $12$h       & $10$  & $1.7$h   \\\midrule[1pt]
	\end{tabular}
	\caption{Running times of the \BDD-decoding attack on binary secret \LWE}
	\label{table:RunTimesBinSecret}
\end{table}
\vspace{20pt}

\paragraph{Binary matrix.} To implement an \LWE-based encryption on lightweight devices, \cite{Galb} proposed not to store the whole random matrix $\AMat \in \Z_q^{n \times m}$, but to generate the entries of a \emph{binary}
$\AMat \in \Z_2^{n \times m}$ via some Pseudorandom Number Generator. Galbraith's ciphertexts are of the form
\[(C_1, C_2) = (\AMat \uvec, \langle \uvec, \bvec \rangle + m \lceil q/2 \rceil \bmod q)
\]
for a message $m \in \{0,1\}$, some uniformly random $\uvec \in {\{0,1\}}^m$ and a modulus
$q \in \Z$. The task is to recover $\uvec$ given $(\AMat, \AMat \uvec)$.

Let us describe a simple lattice attack on the instance $(\AMat, \AMat \uvec)$. Notice
that $C_1 = \AMat \uvec$ holds over $\Z$ and, hence, over $\Z_q$ for large enough
modulus $q$ since we expect to have $\AMat \uvec \approx m/4 < q$. First, we find any solution
$\wvec$ for $\AMat \wvec = C_1 \mod q$. Note that
\[(\wvec- \uvec) \in \ker (\AMat).
\]
So
we have a \BDD{} instance $(\qLATTp (\AMat), \wvec)$, with $\uvec$ as the
error-vector of expected length $m/2$ and a lattice with $\det(\qLATTp(\AMat))= q^n$.
Since we can freely choose $q$ to be as large as we want, we can guarantee that
$\lambda_1 (\qLATTp(\AMat)) \gg m/2$. Such an instance can be solved by first
running $\beta$-\BKZ{} for some small constant $\beta$ and then Babai's $\CVP$ algorithm.

As a challenge, Galbraith proposes a parameter-set $(n=256, m=400)$ and estimates
that computing $\uvec$ from $\AMat \uvec$ should take around one day.
We solve this instance using NTL's \BKZ{} implementation with $\beta = 4$ and $q
= 500009$ in 4.5 hours.

\vspace{20pt}
\begin{table}[h]
	\centering
	\begin{tabular}{cccc|c|cc}
		\toprule
		\multicolumn{4}{c|}{\LWE-parameters}               & {\BKZ-reduction}  & {Babai's \CVP} \\
		$n$   & $q$          & $m$   & $\beta$ & $T$        &  $T$      \\\midrule
		$256$ & $500009$     & $400$ & $4$     & $4.5$h     & $2 \text{min}$                  \\
		$280$ & $500009$     & $440$ & $4$     & $6.5$h     & $3 \text{min}$                  \\\bottomrule
	\end{tabular}
	\caption{Running times of the \BDD-decoding attack on cryptosystem based on binary matrix \LWE}
	\label{table:RunTimesBinMatrix}
\end{table}