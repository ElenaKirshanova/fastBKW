\documentclass[a4paper,12pt]{article}
\usepackage{sibecrypt}


\begin{document}

\section{Àëãîðèòì äëÿ $appSVP_{\gamma}$ íà $q$-àðíîé ðåøåòêå}

Â ýòîì ðàçäåëå ìû ïðåäñòàâèì êîìáèíàòîðíûé àëãîðèòì, êîòîðûé ïîëó÷àÿ íà âõîäå $A \in Z_q^{n \times 2n}$ and $c_{\gamma} < c_q/2 - 1/2$, âûâîäèò âåêòîð $\vec{v} \in L^{\perp}_q (A) \subset Z_q^{2n}$ òàêîé ÷òî \ $\| \vec{v} \| \leq n^{c_{\gamma}+c_q/2+1/2}$. Îòìåòèì, ÷òî ìû çàäàåì ðàçìåðíîñòü ðåøåòêè $m$ êàê $m=2n$. Òàêîé âûáîð óïðîùàåò îïèñàíèå è íåîáõîäèì äëÿ óëó÷øåíèÿ àëãîðèòìà â äàëüíåéøåì.

Àëãîðèòì ïðåäñòàâëÿåò ñîáîé êîìáèíàòîðíûé àëãîðèòì òèïà BKW äëÿ çàäà÷è LWE àäàïòèðîâàííûé äëÿ çàäà÷è $appSVP_{\gamma}$. Ïðèâåäåì òåïåðü åãî äåòàëüíûé îáçîð.

Èäåÿ ñîñòîèò â ðàçäåëåíèè ðàçìåðíîñòè ðåøåòêè $2n$ íà $k$ áëîêîâ $d_1,...,d_k$, ò.å. $\sum_{i = 1}^k d_i = 2n$. Ìû òàêæå âûáèðàåì $k$ ïîëîæèòåëüíûõ çíà÷åíèé $R_1,...,R_k$, ãäå $R_i < q/2$ äëÿ âñåõ $i$. Àëãîðèòì ïðîäîëæàåòñÿ $k$ øàãîâ.

Íà ïåðâîì øàãå ìû èùåì ïàðû âåêòîðîâ ðåøåòêè $(\vec{v_1}, \vec{v_2})$, òàêèå ÷òî
\[
\Big\lfloor \frac{[\vec{v_1}]_1^{d_1}}{R_1} \Big\rceil =  \Big\lfloor \frac{[\vec{v_2}]_1^{d_1}}{R_1} \Big\rceil\footnote{Èñïîëüçóÿ îïðåäåëåíèå $[\vec{x}]_i^j = x_i\ldots x_j$ for $i \leq j$.}.
\]

Èíûìè ñëîâàìè, ìû ðàçäåëÿåì íàø $q$-àðíûé êóá $[- \frac{q-1}{2}, \frac{q-1}{2}]^{d_1}$ íà ìíîæåñòâî ìåíüøèõ êóáîâ $[-R_1, R_1]^{d_1}$  è èùåì ïàðû $(\vec{v_1}, \vec{v_2})$, ÷üè ïåðâûå $d_1$ êîîðäèíàò ëåæàò â îäíîì êóáå. Â íàøåì àëãîðèòìå ìû çàäàåì $R_1 = n^{o(1)} \ll q$,  è ìû ìîæåì ðåãóëèðîâàòü âûáîð $R_1$ òàê, ÷òî ìàëûå êóáû äåëÿò áîëüøîé êóá ðàâíîìåðíî.

Êàê òîëüêî äâà òàêèõ âåêòîðà íàéäåíû, ìû âû÷èòàåì îäèí èç äðóãîãî è îòïðàâëÿåì ðåçóëüòàò â ñïèñîê $L_1$. Âàæíî îòìåòèòü, ÷òî ìû ìîæåì îãðàíè÷èòü $l_{\infty}$ - íîðìó ýëåìåíòîâ â $L_1$: â ñðåäíåì,  $\| [\vec{v_1} - \vec{v_2}]_1^{d_1}\|_{\infty} \leq \sqrt{2}R_1$. Âûâîäîì øàãà 1 ÿâëÿåòñÿ ìíîæåñòâî âåêòîðîâ ñ îãðàíè÷åííîé $l_{\infty}$ - íîðìîé íà èõ ïåðâûõ $d_1$ êîîðäèíàòàõ. Íà âòîðîì øàãå ìû èñïîëüçóåì âåêòîðû èç $L_1$ äëÿ ïîèñêà ïàð, êîòîðûå ëåæàò â îäíîì è òîì æå $[-R_2, R_2]^{d_2}$ êóáå íà èõ $d_1 + 1,...,d_2$ êîîðäèíàòàõ àíàëîãè÷íî øàãó 1. Âûâîäîì øàãà 2 ÿâëÿåòñÿ ñïèñîê $L_2$ âåêòîðîâ îãðàíè÷åííûõ â $l_{\infty}$ - íîðìå ïî êîîðäèíàòàì $1,...,d_1$ è $d_1 + 1,...,d_2$.

Ïîâòîðÿÿ ýòó ïðîöåäóðó äëÿ âñåõ $k$ øàãîâ, ìû çàêîíè÷èì ñ âåêòîðàìè ðåøåòêè äëÿ êîòîðûõ ìû ìîæåì îãðàíè÷èòü èõ $l_{\infty}$ - íîðìó íà âñåõ $2n$ êîîðäèíàòàõ è ñëåäîâàòåëüíî, Åâêëèäîâó íîðìó. Èç âåðõíåé ãðàíèöû äëèíû âûõîäíûõ äàííûõ, ìû íàéäåì îïòèìàëüíîå ïî $k$. Îáñóæäåíèå êàê âûáðàòü $R_i$-ûå è $k$ îñòàâèì íà ñëåäóþùèé ïóíêò.

Ñóùåñòâóåò ïðîñòîé òðþê, êîòîðûé çíà÷èòåëüíî óëó÷øàåò âðåìÿ ðàáîòû àëãîðèòìà. Ìû ìîæåì çàïèñàòü íàøó âõîäíóþ ìàòðèöó $A \in Z_q^{n \times 2n}$ êàê $A = [A_1 | A_2]$, ãäå $A_i \in Z_q^{n \times n}$. Ñ âûñîêîé âåðîÿòíîñòüþ, $A_1$ îáðàòèìà ïî mod $q$, ïîçâîëÿÿ íàì çàïèñàòü $A = [Id_n | A^{'}]$, ãäå $A^{'} = A^{-1}_1 A_2$ mod $q$. Ïî ñóòè ýòà ïðîöåäóðà ïðèâîäèò $q$ - àðíûé êîä, ñãåíåðèðîâàííûé $A$, â ñèñòåìàòè÷åñêóþ ôîðìó. Ëåãêî ïðîâåðèòü, ÷òî áàçèñ $L^{\perp}_q (A)$ èìååò âèä 
\begin{equation} \label{eq:BasisD}
	D = \begin{pmatrix}
	-A' & q Id_n \\
	Id_{n} & 0
	\end{pmatrix}.
\end{equation}

Òåïåðü ìû èñïîëüçóåì ýòîò áàçèñ äëÿ ãåíåðàöèè âåêòîðîâ ðåøåòêè, ÷òîáû ïðîèçâåñòè íà÷àëüíûé ïîèñê. Âûáåðåì $\vec{x}  = (x_1, \ldots, x_n, x_{n+1}, x_{2n}) \in Z_q^{2n}$ è ïðîèçâåäåì âåêòîðû
\[
D \vec{x} \bmod q = (y_1,  \ldots,  y_n,  x_{n+1}, \ldots, x_{2n})^{t}.
\]
Òàêèì îáðàçîì, ìû ìîæåì óæå îãðàíè÷èòü $l_{\infty}$ - íîðìó âåêòîðîâ êðàéíèõ ïðàâûõ $n$ êîîðäèíàò âûáðàâ $(x_{n+1},...,x_n)$, ñêàæåì, ìåíüøå, ÷åì $R_1$ (êàê áóäòî ìû óæå ðàñïðåäåëèëè ïî êîðçèíàì ïðàâóþ ÷àñòü). Ìû îòïðàâëÿåì âåêòîðû òàêîãî âèäà â íàø íà÷àëüíûé ñïèñîê $L_0$. Ýëåìåíòû èç ýòîãî ñïèñêà ïîçâîëÿò íàì ïðîèçâåñòè íàø "cube-bucketing" ïðîöåññ íà îñòàâøèõñÿ ëåâûõ $n$ êîîðäèíàòàõ òîëüêî â îòëè÷èå îò $2n$.

Íèæå ïðèâåäåí àëãîðèòì íà ïñåâäî-êîäå. Ìàññèâ $T$ â ïñåâäî-êîäå ñëóæèò ñïðàâî÷íîé òàáëèöåé: íà øàãå $i$, îí ïðîèíäåêñèðîâàí $d_i$-ìåðíûìè âåêòîðàìè (êîðçèíàìè) $b$ è âñÿêèé ðàç, êîãäà ìû íàøëè âåêòîð $\vec{v}$, òàêîé, ÷òî $\Big\lfloor \frac{[\vec{v_1}]_1^{d_1}}{R_1} \Big\rceil = b$, ìû ñìîòðèì ïóñò $T[b]$ èëè íåò. Â ïîñëåäíåì ñëó÷àå, íàéäåíà êîëëèçèÿ è íîâûé âåêòîð äîáàâëÿåòñÿ â $L_i$.

\begin{algorithm}[t]
	\caption{$appSVP_{\gamma}$ íà $q$-àðíîé ðåøåòêå}
	\textbf{Âõîä:} $D$ -- áàçèñ ðåøåòêè $L^{\perp}_q (A) \subset Z_q^{2n}$ çàäàííûé êàê â ~(\ref{eq:BasisD}), $\gamma = n^{c_{\gamma}}$ -- ôàêòîð àïïðîêñèìàöèè, $c_{\gamma}>0$ \\
	\textbf{Âûõîä:} $L_k$ --ñïèñîê âåêòîðîâ èç $L^{\perp}_q (A)$, ãäå âñå âåêòîðû íîðìû $\| \vec{v} \| \leq n^{c_{\gamma}+c_q/2+1/2}$;
	
	\begin{algorithmic}[1]
		
		\item Çàäàåì ãðàíèöû ïðîñåèâàíèÿ $R_i$ êàê $R_1 = n^{o(1)}$ è $R_i = \sqrt{2}^{i-1} R_1$ äëÿ $i \geq 2$.
		\item Çàäàåì äëèíó áëîêîâ $d_i$ êàê in Eq.(4.18) è ãðàíèöû êàæäîãî áëîêà $(l_{i-1}, \ldots, l_i)$ òàêèå, ÷òî \ $l_{i}-{l_{i-1}} = d_i$ è $l_k = 1, l_0 = n$.
		
		\item \textbf{repeat}
		\item Âûáèðàåì $\vec{x} \in Z_q^{2n}$ òàêîé, ÷òî \ $\| [\vec{x}]_{n+1}^{2n} \|_{\infty} \leq R_1$
		\item $L_0 \gets L_0  \cup \{D\vec{x} \bmod q\}$
		\item \textbf{until} {$L_0$ äîñòàòî÷íî áîëüøîé}
		
		\item $T \gets \emptyset$
		\item \textbf{for all} {$i=1 \ldots k$}
		\item	\textbf{for all} { $\vec{v} \in L_{i-1}$}
		\item		$b \gets \Big\lfloor \frac{[\vec{v}]_{l_i}^{l_{i-1}}}{R_i} \Big\rceil$
		\item		\textbf{if} {$T[b] = \emptyset$}
		\item			$T[b] \gets \vec{v}$
		\item		\textbf{else}
		\item			$L_{i} \gets L_{i} \cup \{T[b] - \vec{v} \}$
		\item			$T[b] \gets \emptyset$
		\item \textbf{return} $L_k$
	\end{algorithmic}
	
	\vspace{10pt}
	
\end{algorithm}

\end{document}

%\begin{Definition}
%\end{Definition}

%\begin{Theorem}
%\end{Theorem}